## 一、基础篇
### 网络基础
#### TCP三次握手

TCP三次握手示意图：

![](http://image.leeyom.top/blog/20210726145341.png)

> tip: 关于几个关键单词的解释及含义：
>
> 1. seq：序列号，TCP通信过程中某一个传输方向上的字节流的每个字节的序号，通过这个来确认发送的数据有序
> 2. ack：确认号，TCP对上一次seq序号做出的确认号，用来响应TCP报文段，给收到的TCP报文段的序号seq加1
> 3. SYN：同步标志位，用于建立会话连接，同步序列号
> 4. ACK：确认标志位，对已接收的数据包进行确认
> 5. FIN：完成标志位，表示我已经没有数据要发送了，即将关闭连接

- **第一次握手**：客户端将TCP报文**标志位SYN=1**，随机产生一个序号值seq=J，保存在TCP首部的序列号(Sequence Number)字段里，指明客户端打算连接的服务器的端口，并将该数据包发送给服务器端，发送完毕后，客户端进入**SYN_SENT**状态，等待服务器端确认。
- **第二次握手**：服务器端收到数据包后由标志位SYN=1知道客户端请求建立连接，服务器端将TCP报文**标志位SYN和ACK都置为1**，ack=J+1，随机产生一个序号值seq=K，并将该数据包发送给客户端以确认连接请求，服务器端进入**SYN_RCVD**状态。
- **第三次握手**：客户端收到确认后，**检查ack是否为J+1，ACK是否为1**，如果正确则将标志位ACK置为1，ack=K+1，并将该数据包发送给服务器端，**服务器端检查ack是否为K+1，ACK是否为1**，如果正确则连接建立成功，客户端和服务器端进入**ESTABLISHED**状态，完成三次握手，随后客户端与服务器端之间可以开始传输数据了。

为什么要握手三次？

- 我们假设client发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达server。
- 本来这是一个早已失效的报文段。但server收到此失效的连接请求报文段后，就误认为是client再次发出的一个新的连接请求。于是就向client发出确认报文段，同意建立连接。
- 假设不采用“三次握手”，那么只要server发出确认，新的连接就建立了。由于现在client并没有发出建立连接的请求，因此不会理睬server的确认，也不会向server发送数据。但server却以为新的运输连接已经建立，并一直等待client发来数据。这样，server的很多资源就白白浪费掉了。
- 总结：**防止因为网络延迟或者其他因素，造成server资源浪费。**

**TCP四次挥手关闭连接**：

![](http://image.leeyom.top/blog/20210726173529.png)

- **第一次挥手**： Client端发起挥手请求，向Server端发送标志位是FIN报文段，设置序列号seq，此时，Client端进入`FIN_WAIT_1`状态，这表示Client端没有数据要发送给Server端了。
- **第二次挥手**：Server端收到了Client端发送的FIN报文段，向Client端返回一个标志位是ACK的报文段，ack设为seq加1，Client端进入`FIN_WAIT_2`状态，Server端告诉Client端，我确认并同意你的关闭请求。
- **第三次挥手**： Server端向Client端发送标志位是FIN的报文段，请求关闭连接，同时Client端进入`LAST_ACK`状态。
- **第四次挥手** ： Client端收到Server端发送的FIN报文段，向Server端发送标志位是ACK的报文段，然后Client端进入`TIME_WAIT`状态。Server端收到Client端的ACK报文段以后，就关闭连接。此时，Client端等待**2MSL**的时间后依然没有收到回复，则证明Server端已正常关闭，那好，Client端也可以关闭连接了。

为什么要等待2MSL？

> **MSL**：报文段最大生存时间，它是任何报文段被丢弃前在网络内的最长时间

- **保证TCP协议的全双工连接能够可靠关闭**
- **保证这次连接的重复数据段从网络中消失**

以上知识参考文章：[一文彻底搞懂 TCP三次握手、四次挥手过程及原理](https://juejin.cn/post/6844904070000410631)

#### OSI与TCP/IP模型

从下往上：

- OSI七层模型：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层
- TCP/IP五层模型：物理层、数据链路层、网络层、传输层、应用层

#### 常见的网络服务分层

- 应用层：HTTP、HTTPS、FTP、Telnet、SSH、SMTP、POP3等
- 传输层：TCP 、UDP
- 网络层：ICMP 、IP
- 数据链路层：以太网、无线局域网（Wi-Fi）和通用分组无线服务（GPRS）等
- 物理层：集线器、中继器等

#### TCP和UDP的区别

![](http://image.leeyom.top/blog/20210726182203.png)

​	**基于TCP的协议：**HTTP、FTP、SMTP

​	**基于UDP的协议：**RIP、DNS、SNMP

#### TCP滑动窗口和拥塞控制

